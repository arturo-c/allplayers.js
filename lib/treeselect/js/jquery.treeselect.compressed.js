(function(b){b.fn.treeselect=function(h){function l(a,d){d?(b('ul[ref="'+a+'"]').show("fast"),b('[ref="'+a+'"]').removeClass("collapsed").addClass("expanded")):(b('ul[ref="'+a+'"]').hide("fast"),b('[ref="'+a+'"]').removeClass("expanded").addClass("collapsed"))}function n(b,d){var b=b||h.tree,d=d||null,i="",c="",k;for(k in b)if(b.hasOwnProperty(k))var j=b[k],c=c+"<li>",c=c+'<input type="checkbox" />',c=c+n(j.children?j.children:[],j),c=c+"</li>";d&&(i=i+(c?'<span class="collapsed"></span>':"")+('<a href="#" class="collapsed">'+
d.title+"</a>"));c&&(i=i+(d?"<ul>":"")+c+(d?"</ul>":""));return i}function o(a,d,i,c){var c=c||h.tree,d=d||0,i=i||0,k=d*h.margin,j=0;a.each(function(){var f=b(this),g=j%2?"even":"odd",a=i+"-"+j,e=0;"odd"==g&&(e=h.basecolor-d*h.gradient,e=e.toString(16),f.css("backgroundColor","#"+(e+e+e)));f.addClass(g);var e=k,g=c?c[j].id:a,m=f.children("input:checkbox");m.attr({ref:a,value:g});m.css("left",e+"px");m.bind("click",{id:a},function(a){var c=b(a.target).is(":checked");c&&l(a.data.id,!0);b('ul[ref="'+
a.data.id+'"] input').each(function(){b(this).attr("checked",c)})});g=f.children("span");e+=h.colwidth+h.space;g.attr("ref",a);g.css({cursor:"pointer",left:e+"px"});g.bind("click",{id:a},function(a){a.preventDefault();l(a.data.id,b(a.target).hasClass("collapsed"))});g=f.children("a");e+=h.colwidth+h.space;g.attr("ref",a);g.css({cursor:"pointer",marginLeft:e+"px"});g.bind("click",{id:a},function(a){a.preventDefault();l(a.data.id,b(a.target).hasClass("collapsed"))});f=f.children("ul");f.attr("ref",
a);f=f.children("li");0<f.length&&o(f,d+1,a,c?c[j].children:null);j++})}h=b.extend({margin:18,space:4,basecolor:238,gradient:8,colwidth:13,tree:null},h);return b(this).each(function(){var a=b(this).children("li");0==a.length&&(b(this).append(n()),a=b(this).children("li"));o(a)})}})(jQuery);

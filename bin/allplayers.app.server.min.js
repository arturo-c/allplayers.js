var NO_JQUERY={};
(function(b,f,e){if(!("console"in b)){var m=b.console={};m.log=m.warn=m.error=m.debug=function(){}}f===NO_JQUERY&&(f={fn:{},extend:function(){for(var a=arguments[0],d=1,c=arguments.length;d<c;d++){var b=arguments[d],k;for(k in b)a[k]=b[k]}return a}});f.fn.pm=function(){console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])");return this};f.pm=b.pm=function(a){c.send(a)};f.pm.bind=b.pm.bind=function(a,d,b,g,k){c.bind(a,d,b,g,!0===k)};f.pm.unbind=b.pm.unbind=function(a,
d){c.unbind(a,d)};f.pm.origin=b.pm.origin=null;f.pm.poll=b.pm.poll=200;var c={send:function(a){a=f.extend({},c.defaults,a);var d=a.target;if(a.target)if(a.type){var b={data:a.data,type:a.type};a.success&&(b.callback=c._callback(a.success));a.error&&(b.errback=c._callback(a.error));"postMessage"in d&&!a.hash?(c._bind(),d.postMessage(JSON.stringify(b),a.origin||"*")):(c.hash._bind(),c.hash.send(a,b))}else console.warn("postmessage type required");else console.warn("postmessage target window required")},
bind:function(a,d,b,g,k){c._replyBind(a,d,b,g,k)},_replyBind:function(a,d,t,g,k){"postMessage"in b&&!g?c._bind():c.hash._bind();g=c.data("listeners.postmessage");g||(g={},c.data("listeners.postmessage",g));var n=g[a];n||(n=[],g[a]=n);n.push({fn:d,callback:k,origin:t||f.pm.origin})},unbind:function(a,d){var b=c.data("listeners.postmessage");if(b)if(a)if(d){var g=b[a];if(g){for(var k=[],n=0,h=g.length;n<h;n++){var l=g[n];l.fn!==d&&k.push(l)}b[a]=k}}else delete b[a];else for(n in b)delete b[n]},data:function(a,
d){return d===e?c._data[a]:c._data[a]=d},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var a=[],d=0;32>d;d++)a[d]=c._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var d=c.data("callbacks.postmessage");d||(d={},c.data("callbacks.postmessage",d));var b=c._random();d[b]=a;return b},_bind:function(){c.data("listening.postmessage")||(b.addEventListener?b.addEventListener("message",c._dispatch,!1):b.attachEvent&&b.attachEvent("onmessage",
c._dispatch),c.data("listening.postmessage",1))},_dispatch:function(a){try{var d=JSON.parse(a.data)}catch(b){console.warn("postmessage data invalid json: ",b);return}if(d.type){var g=(c.data("callbacks.postmessage")||{})[d.type];if(g)g(d.data);else for(var g=(c.data("listeners.postmessage")||{})[d.type]||[],k=0,n=g.length;k<n;k++){var h=g[k];if(h.origin&&"*"!==h.origin&&a.origin!==h.origin)console.warn("postmessage message origin mismatch",a.origin,h.origin),d.errback&&c.send({target:a.source,data:{message:"postmessage origin mismatch",
origin:[a.origin,h.origin]},type:d.errback});else{var l=function(b){d.callback&&c.send({target:a.source,data:b,type:d.callback})};try{h.callback?h.fn(d.data,l,a):l(h.fn(d.data,a))}catch(e){if(d.errback)c.send({target:a.source,data:e,type:d.errback});else throw e;}}}}else console.warn("postmessage message type required")},hash:{send:function(a,d){var e=a.target,g=a.url;if(g){var g=c.hash._url(g),k,n=c.hash._url(b.location.href);if(b==e.parent)k="parent";else try{for(var h=0,l=parent.frames.length;h<
l;h++)if(parent.frames[h]==b){k=h;break}}catch(f){k=b.name}null==k?console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list"):(k={"x-requested-with":"postmessage",source:{name:k,url:n},postmessage:d},n="#x-postmessage-id="+c._random(),e.location=g+n+encodeURIComponent(JSON.stringify(k)))}else console.warn("postmessage target window url is required")},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:50,_bind:function(){c.data("polling.postmessage")||
(setInterval(function(){var a=""+b.location.hash,d=c.hash._regex.exec(a);d&&(d=d[1],c.hash._last!==d&&(c.hash._last=d,c.hash._dispatch(a.substring(c.hash._regex_len))))},f.pm.poll||200),c.data("polling.postmessage",1))},_dispatch:function(a){if(a){try{if(a=JSON.parse(decodeURIComponent(a)),!("postmessage"===a["x-requested-with"]&&a.source&&null!=a.source.name&&a.source.url&&a.postmessage))return}catch(d){return}var e=a.postmessage,g=(c.data("callbacks.postmessage")||{})[e.type];if(g)g(e.data);else{var k;
k="parent"===a.source.name?b.parent:b.frames[a.source.name];for(var g=(c.data("listeners.postmessage")||{})[e.type]||[],n=0,h=g.length;n<h;n++){var l=g[n];if(l.origin){var f=/https?\:\/\/[^\/]*/.exec(a.source.url)[0];if("*"!==l.origin&&f!==l.origin){console.warn("postmessage message origin mismatch",f,l.origin);e.errback&&c.send({target:k,data:{message:"postmessage origin mismatch",origin:[f,l.origin]},type:e.errback,hash:!0,url:a.source.url});continue}}f=function(b){e.callback&&c.send({target:k,
data:b,type:e.callback,hash:!0,url:a.source.url})};try{l.callback?l.fn(e.data,f):f(l.fn(e.data))}catch(m){if(e.errback)c.send({target:k,data:m,type:e.errback,hash:!0,url:a.source.url});else throw m;}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}}};f.extend(c,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})})(this,"undefined"===typeof jQuery?NO_JQUERY:jQuery);"JSON"in window&&window.JSON||(JSON={});
(function(){function b(a){return 10>a?"0"+a:a}function f(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var b=t[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(b,c){var h,l,m,r,s=a,q,p=c[b];p&&"object"===typeof p&&"function"===typeof p.toJSON&&(p=p.toJSON(b));"function"===typeof g&&(p=g.call(c,b,p));switch(typeof p){case "string":return f(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";a+=d;q=[];if("[object Array]"===Object.prototype.toString.apply(p)){r=p.length;for(h=0;h<r;h+=1)q[h]=e(h,p)||"null";m=0===q.length?"[]":a?"[\n"+a+q.join(",\n"+a)+"\n"+s+"]":"["+q.join(",")+"]";a=s;return m}if(g&&"object"===typeof g)for(r=g.length,h=0;h<r;h+=1)l=g[h],"string"===typeof l&&(m=e(l,p))&&q.push(f(l)+(a?": ":":")+m);else for(l in p)Object.hasOwnProperty.call(p,l)&&(m=e(l,p))&&q.push(f(l)+(a?": ":":")+m);m=0===q.length?"{}":a?"{\n"+a+q.join(",\n"+a)+"\n"+
s+"}":"{"+q.join(",")+"}";a=s;return m}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var m=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,d,t={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,h){var f;d=a="";if("number"===typeof h)for(f=0;f<h;f+=1)d+=" ";else"string"===typeof h&&(d=h);if((g=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return e("",{"":b})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function d(a,c){var e,g,f=a[c];if(f&&"object"===typeof f)for(e in f)Object.hasOwnProperty.call(f,e)&&(g=d(f,e),void 0!==g?f[e]=g:delete f[e]);return b.call(a,c,f)}var c;m.lastIndex=0;m.test(a)&&(a=a.replace(m,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return c=eval("("+a+")"),"function"===typeof b?d({"":c},""):c;throw new SyntaxError("JSON.parse");})})();var allplayers=allplayers||{};allplayers.app=function(b,f){if(f){b=b||{};for(var e in f)b.hasOwnProperty(e)||(b[e]=f[e]);this.options=b;this.init()}};allplayers.app.getParam=function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");b=RegExp("[\\?&]"+b+"=([^&#]*)").exec(window.location.search);return null==b?"":decodeURIComponent(b[1].replace(/\+/g," "))};
allplayers.app.prototype.init=function(){document.proxy=this};allplayers=allplayers||{app:{}};jQuery.fn.allplayers_server||(jQuery.fn.allplayers_server=function(b){return jQuery(this).each(function(){new allplayers.app.server(b,jQuery(this))})});allplayers.app.server=function(b,f){this.context=f;allplayers.app.call(this,b,{spinner:"",loading:"Loading",base:"https://platform.allplayers.com",type:"registration",group:"api",query:{},reg:{},src:"",style:"",complete:function(){}})};
allplayers.app.server.prototype=new allplayers.app;allplayers.app.server.prototype.constructor=allplayers.app.server;
allplayers.app.server.prototype.init=function(){allplayers.app.prototype.init.call(this);this.baseURL="https://platform.allplayers.com";this.options.base&&(this.baseURL=this.options.base);this.isLoading=!0;this.options.spinner||(this.options.spinner=this.options.base,this.options.spinner+="/sites/all/themes/basic_foundation",this.options.spinner+="/images/loader.gif");this.pluginReady=!1;var b=jQuery(document.createElement("div")).css({background:"url("+this.options.spinner+") no-repeat 10px 13px",
padding:"10px 10px 10px 60px",width:"100%"});b.append(this.options.loading);var f=this.context.attr("id")+"_iframe",e="";if(e=allplayers.app.getParam("apq"))e=this.options.base+"/"+e;else if(this.options.src)e=this.options.src;else{e=this.options.base+"/g/"+this.options.group;switch(this.options.type){case "registration":e+="/register";break;case "forms":e+="/forms"}this.options.query.etyp=this.options.type}e+=-1===e.search(/\?/)?"?":"&";if(!function(a){for(var b in a)return!1;return!0}(this.options.query))for(var m in this.options.query)e+=
m+"="+encodeURIComponent(this.options.query[m]),e+="&";var e=e+("#"+f),c=this,a=jQuery(document.createElement("iframe")).attr({id:f,name:f,scrolling:"no",seamless:"seamless",width:"100%",height:"0px",src:e}).css({border:"none",overflowY:"hidden"});this.context.append(b);this.context.append(a);a.eq(0);$.pm.bind("chromePluginReady",function(){c.pluginReady=!0});$.pm.bind("chromeMsgResp",function(a){$.pm({target:window.frames,url:c.baseURL,type:"chromeMsgResp",data:a})});$.pm.bind("chromeMsg",function(a){$.pm({target:window,
type:"chromeMsg",data:a})});$.pm.bind("init",function(d){c.isLoading=!1;b.remove();a.height(d.height).attr("height",d.height+"px");return d});$.pm.bind("addProduct",function(a){$("<input>").attr({type:"hidden",name:"add-product[]",value:JSON.stringify(a)}).appendTo("form");$("#edit-next").val("Continue")});$.pm.bind("clientReady",function(a){c.pluginReady&&$.pm({target:window.frames,url:c.baseURL,type:"chromePluginReady"});$.pm({target:window.frames,url:c.baseURL,type:"getRegistration",data:c.options.reg})})};

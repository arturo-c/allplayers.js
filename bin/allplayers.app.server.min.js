var NO_JQUERY={};
(function(b,d,f){if(!("console"in b)){var p=b.console={};p.log=p.warn=p.error=p.debug=function(){}}d===NO_JQUERY&&(d={fn:{},extend:function(){for(var a=arguments[0],h=1,c=arguments.length;h<c;h++){var e=arguments[h],g;for(g in e)a[g]=e[g]}return a}});d.fn.pm=function(){console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])");return this};d.pm=b.pm=function(a){c.send(a)};d.pm.bind=b.pm.bind=function(a,h,b,e,g){c.bind(a,h,b,e,!0===g)};d.pm.unbind=b.pm.unbind=function(a,
h){c.unbind(a,h)};d.pm.origin=b.pm.origin=null;d.pm.poll=b.pm.poll=200;var c={send:function(a){a=d.extend({},c.defaults,a);var h=a.target;if(a.target)if(a.type){var b={data:a.data,type:a.type};a.success&&(b.callback=c._callback(a.success));a.error&&(b.errback=c._callback(a.error));"postMessage"in h&&!a.hash?(c._bind(),h.postMessage(JSON.stringify(b),a.origin||"*")):(c.hash._bind(),c.hash.send(a,b))}else console.warn("postmessage type required");else console.warn("postmessage target window required")},
bind:function(a,h,b,e,g){c._replyBind(a,h,b,e,g)},_replyBind:function(a,h,s,e,g){"postMessage"in b&&!e?c._bind():c.hash._bind();e=c.data("listeners.postmessage");e||(e={},c.data("listeners.postmessage",e));var m=e[a];m||(m=[],e[a]=m);m.push({fn:h,callback:g,origin:s||d.pm.origin})},unbind:function(a,h){var b=c.data("listeners.postmessage");if(b)if(a)if(h){var e=b[a];if(e){for(var g=[],m=0,l=e.length;m<l;m++){var k=e[m];k.fn!==h&&g.push(k)}b[a]=g}}else delete b[a];else for(m in b)delete b[m]},data:function(a,
b){return b===f?c._data[a]:c._data[a]=b},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var a=[],b=0;32>b;b++)a[b]=c._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var b=c.data("callbacks.postmessage");b||(b={},c.data("callbacks.postmessage",b));var f=c._random();b[f]=a;return f},_bind:function(){c.data("listening.postmessage")||(b.addEventListener?b.addEventListener("message",c._dispatch,!1):b.attachEvent&&b.attachEvent("onmessage",
c._dispatch),c.data("listening.postmessage",1))},_dispatch:function(a){try{var b=JSON.parse(a.data)}catch(f){console.warn("postmessage data invalid json: ",f);return}if(b.type){var e=(c.data("callbacks.postmessage")||{})[b.type];if(e)e(b.data);else for(var e=(c.data("listeners.postmessage")||{})[b.type]||[],g=0,m=e.length;g<m;g++){var l=e[g];if(l.origin&&"*"!==l.origin&&a.origin!==l.origin)console.warn("postmessage message origin mismatch",a.origin,l.origin),b.errback&&c.send({target:a.source,data:{message:"postmessage origin mismatch",
origin:[a.origin,l.origin]},type:b.errback});else{var k=function(e){b.callback&&c.send({target:a.source,data:e,type:b.callback})};try{l.callback?l.fn(b.data,k,a):k(l.fn(b.data,a))}catch(d){if(b.errback)c.send({target:a.source,data:d,type:b.errback});else throw d;}}}}else console.warn("postmessage message type required")},hash:{send:function(a,h){var f=a.target,e=a.url;if(e){var e=c.hash._url(e),g,m=c.hash._url(b.location.href);if(b==f.parent)g="parent";else try{for(var l=0,k=parent.frames.length;l<
k;l++)if(parent.frames[l]==b){g=l;break}}catch(d){g=b.name}null==g?console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list"):(g={"x-requested-with":"postmessage",source:{name:g,url:m},postmessage:h},m="#x-postmessage-id="+c._random(),f.location=e+m+encodeURIComponent(JSON.stringify(g)))}else console.warn("postmessage target window url is required")},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:50,_bind:function(){c.data("polling.postmessage")||
(setInterval(function(){var a=""+b.location.hash,f=c.hash._regex.exec(a);f&&(f=f[1],c.hash._last!==f&&(c.hash._last=f,c.hash._dispatch(a.substring(c.hash._regex_len))))},d.pm.poll||200),c.data("polling.postmessage",1))},_dispatch:function(a){if(a){try{if(a=JSON.parse(decodeURIComponent(a)),!("postmessage"===a["x-requested-with"]&&a.source&&null!=a.source.name&&a.source.url&&a.postmessage))return}catch(f){return}var d=a.postmessage,e=(c.data("callbacks.postmessage")||{})[d.type];if(e)e(d.data);else{var g;
g="parent"===a.source.name?b.parent:b.frames[a.source.name];for(var e=(c.data("listeners.postmessage")||{})[d.type]||[],m=0,l=e.length;m<l;m++){var k=e[m];if(k.origin){var q=/https?\:\/\/[^\/]*/.exec(a.source.url)[0];if("*"!==k.origin&&q!==k.origin){console.warn("postmessage message origin mismatch",q,k.origin);d.errback&&c.send({target:g,data:{message:"postmessage origin mismatch",origin:[q,k.origin]},type:d.errback,hash:!0,url:a.source.url});continue}}q=function(b){d.callback&&c.send({target:g,
data:b,type:d.callback,hash:!0,url:a.source.url})};try{k.callback?k.fn(d.data,q):q(k.fn(d.data))}catch(p){if(d.errback)c.send({target:g,data:p,type:d.errback,hash:!0,url:a.source.url});else throw p;}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}}};d.extend(c,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})})(this,"undefined"===typeof jQuery?NO_JQUERY:jQuery);"JSON"in window&&window.JSON||(JSON={});
(function(){function b(a){return 10>a?"0"+a:a}function d(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var b=s[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(b,c){var l,k,q,p,t=a,r,n=c[b];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(b));"function"===typeof e&&(n=e.call(c,b,n));switch(typeof n){case "string":return d(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";a+=h;r=[];if("[object Array]"===Object.prototype.toString.apply(n)){p=n.length;for(l=0;l<p;l+=1)r[l]=f(l,n)||"null";q=0===r.length?"[]":a?"[\n"+a+r.join(",\n"+a)+"\n"+t+"]":"["+r.join(",")+"]";a=t;return q}if(e&&"object"===typeof e)for(p=e.length,l=0;l<p;l+=1)k=e[l],"string"===typeof k&&(q=f(k,n))&&r.push(d(k)+(a?": ":":")+q);else for(k in n)Object.hasOwnProperty.call(n,k)&&(q=f(k,n))&&r.push(d(k)+(a?": ":":")+q);q=0===r.length?"{}":a?"{\n"+a+r.join(",\n"+a)+"\n"+
t+"}":"{"+r.join(",")+"}";a=t;return q}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var p=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,h,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var k;h=a="";if("number"===typeof d)for(k=0;k<d;k+=1)h+=" ";else"string"===typeof d&&(h=d);if((e=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return f("",{"":b})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function e(a,c){var d,f,g=a[c];if(g&&"object"===typeof g)for(d in g)Object.hasOwnProperty.call(g,d)&&(f=e(g,d),void 0!==f?g[d]=f:delete g[d]);return b.call(a,c,g)}var c;p.lastIndex=0;p.test(a)&&(a=a.replace(p,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return c=eval("("+a+")"),"function"===typeof b?e({"":c},""):c;throw new SyntaxError("JSON.parse");})})();var allplayers=allplayers||{};allplayers.app=function(b,d){if(d){b=b||{};for(var f in d)b.hasOwnProperty(f)||(b[f]=d[f]);this.options=b;this.init()}};allplayers.app.getParam=function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");b=RegExp("[\\?&]"+b+"=([^&#]*)").exec(window.location.search);return null==b?"":decodeURIComponent(b[1].replace(/\+/g," "))};
allplayers.app.prototype.init=function(){document.proxy=this};allplayers=allplayers||{app:{}};jQuery.fn.allplayers_server||(jQuery.fn.allplayers_server=function(b){return jQuery(this).each(function(){new allplayers.app.server(b,jQuery(this))})});allplayers.app.server=function(b,d){this.context=d;allplayers.app.call(this,b,{spinner:"",loading:"Loading",base:"https://platform.allplayers.com",type:"registration",group:"api",query:{},reg:{},src:"",style:"",complete:function(){}})};
allplayers.app.server.prototype=new allplayers.app;allplayers.app.server.prototype.constructor=allplayers.app.server;
allplayers.app.server.prototype.init=function(){allplayers.app.prototype.init.call(this);this.baseURL="https://platform.allplayers.com";this.options.base&&(this.baseURL=this.options.base);this.isLoading=!0;this.options.spinner||(this.options.spinner=this.options.base,this.options.spinner+="/sites/all/themes/basic_foundation",this.options.spinner+="/images/loader.gif");this.pluginReady=!1;var b=jQuery(document.createElement("div")).css({background:"url("+this.options.spinner+") no-repeat 10px 13px",
padding:"10px 10px 10px 60px",width:"100%"});b.append(this.options.loading);var d=this.context.attr("id")+"_iframe",f="";if(f=allplayers.app.getParam("apq"))f=this.options.base+"/"+f;else if(this.options.src)f=this.options.src;else{f=this.options.base+"/g/"+this.options.group;switch(this.options.type){case "registration":f+="/register";break;case "forms":f+="/forms"}this.options.query.etyp=this.options.type}f+=-1===f.search(/\?/)?"?":"&";if(!function(a){for(var b in a)return!1;return!0}(this.options.query))for(var p in this.options.query)f+=
p+"="+encodeURIComponent(this.options.query[p]),f+="&";var f=f+("#"+d),c=this,a=jQuery(document.createElement("iframe")).attr({id:d,name:d,scrolling:"no",seamless:"seamless",width:"100%",height:"0px",src:f}).css({border:"none",overflowY:"hidden"});this.context.append(b);this.context.append(a);var h=null;$.pm.bind("chromePluginReady",function(){c.pluginReady=!0});$.pm.bind("chromeMsgResp",function(a){$.pm({target:h,url:c.baseURL,type:"chromeMsgResp",data:a})});$.pm.bind("chromeMsg",function(a){$.pm({target:h,
url:c.baseURL,type:"chromeMsg",data:a})});$.pm.bind("init",function(e,d){h=d.source;c.isLoading=!1;b.remove();a.height(e.height).attr("height",e.height+"px");return e});var s=function(a){return $('input[product="'+a+'"]')};$.pm.bind("addProduct",function(a){var b=a.product_uuid,c=s(b).val();c?(c=JSON.parse(c),c.quantity=parseInt(c.quantity),c.quantity+=parseInt(a.quantity),s(b).val(JSON.stringify(c)),$("#add-product-display-"+b+" td:last").text(c.quantity)):a.product_uuid&&a.price&&a.quantity&&a.title&&
($("<input>").attr({type:"hidden",product:b,name:"add-product[]",value:JSON.stringify(a)}).appendTo("form#og-registration-register-app"),$("#edit-next").val("Continue"),0==$("#add-products-table").length&&($("<table>").attr({id:"add-products-table","class":"sticky-table"}).appendTo("#add-products"),$("#add-products-table").append("<thead><tr><th>Added Products</th><th>Price</th><th>Quantity</th></tr></thead><tbody></tbody>")),$("#add-products-table tbody").append('<tr id="add-product-display-'+b+
'"><td>'+a.title+"</td><td>"+a.price+"</td><td>"+a.quantity+"</td></tr>"))});$.pm.bind("removeProduct",function(a){a=a.product_uuid;s(a).val()&&(s(a).remove(),$("#add-product-display-"+a).remove())});$.pm.bind("clientReady",function(a,b){h=b.source;c.pluginReady&&$.pm({target:b.source,url:c.baseURL,type:"chromePluginReady"});$.pm({target:b.source,url:c.baseURL,type:"getRegistration",data:c.options.reg})})};

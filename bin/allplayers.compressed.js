var allplayers=allplayers||{};allplayers.date=function(a,b,c){this.newDate=function(a){return"string"===typeof a?new Date(a):"object"===typeof a?a:new Date};this.start=this.newDate(a);this.end=this.newDate(b);this.repeat=c?{interval:c.interval?c.interval:1,freq:c.freq?c.freq:"DAILY",until:this.newDate(c.until),bymonth:c.bymonth?c.bymonth:[],bymonthday:c.bymonthday?c.bymonthday:[],byday:c.byday?c.byday:[],exdate:c.exdate?c.exdate:[],rdate:c.rdate?c.rdate:[]}:null};
if(!Date.prototype.toISOString){var padzero=function(a){return 10>a?"0"+a:a},pad2zeros=function(a){100>a&&(a="0"+a);10>a&&(a="0"+a);return a};Date.prototype.toISOString=function(){var a=this.getUTCFullYear()+"-",a=a+(padzero(this.getUTCMonth()+1)+"-"),a=a+(padzero(this.getUTCDate())+"T"),a=a+(padzero(this.getUTCHours())+":"),a=a+(padzero(this.getUTCMinutes())+":"),a=a+(padzero(this.getUTCSeconds())+".");return a+=pad2zeros(this.getUTCMilliseconds())+"Z"}}
allplayers.date.prototype.update=function(a,b,c){this.start=a?this.newDate(a):this.start;this.end=b?this.newDate(b):this.end;if(c)c.until=this.newDate(c.until),jQuery.extend(this.repeat,c)};allplayers.date.prototype.addDate=function(a,b){b=this.newDate(b);this.repeat[a].push(b)};allplayers.date.prototype.addException=function(a){this.addDate("except",a)};allplayers.date.prototype.addRDate=function(a){this.addDate("rdate",a)};
allplayers.date.prototype.getObject=function(){var a=0,b={start:this.start.toISOString(),end:this.end.toISOString()};if(this.repeat){b.repeat={interval:this.repeat.interval,freq:this.repeat.freq,until:this.repeat.until.toISOString(),bymonth:this.repeat.bymonth,bymonthday:this.repeat.bymonthday,byday:this.repeat.byday,exdate:[],rdate:[]};for(a=this.repeat.exdate.length;a--;)b.repeat.exdate.push(this.repeat.exdate[a].toISOString());for(a=this.repeat.rdate.length;a--;)b.repeat.rdate.push(this.repeat.rdate[a].toISOString())}return b};
allplayers=allplayers||{};allplayers.event=function(a,b){if(a)this.allDay=this.allDay||!1,this.gids=this.gids||[],this.description=this.description||"",this.resources=this.resources||[],this.competitors=this.competitors||{},this.category=a.category?a.category:"Other",this.date=new allplayers.date(a.start,a.end),this.start=this.date.start,this.end=this.date.end,this.api=this.api||new allplayers.event.api;drupal.node.call(this,a,b)};allplayers.event.prototype=new drupal.node;
allplayers.event.prototype.constructor=allplayers.event;allplayers.event.prototype.update=function(a){drupal.node.prototype.update.call(this,a);if(a)this.id=a.uuid||this.id};allplayers.event.prototype.getObject=function(){return jQuery.extend(drupal.node.prototype.getObject.call(this),{allDay:this.allDay,gids:this.gids,description:this.description,resources:this.resources,competitors:this.competitors,category:this.category,date_time:this.date.getObject()})};allplayers=allplayers||{};
allplayers.event=allplayers.event||{};allplayers.event.api=function(){this.resource="events";drupal.api.call(this)};allplayers.event.api.prototype=new drupal.api;allplayers.event.api.prototype.constructor=allplayers.event.api;allplayers=allplayers||{};
allplayers.group=function(a,b){if(a)this.location=this.location||new allplayers.location,this.activity_level=this.activity_level||0,this.list_in_directory=this.list_in_directory||0,this.active=this.active||!1,this.registration_fees_enabled=this.registration_fees_enabled||"",this.approved_for_payment=this.approved_for_payment||"",this.accept_amex=this.accept_amex||"",this.primary_color=this.primary_color||"",this.secondary_color=this.secondary_color||"",this.node_status=this.node_status||0,this.logo=
this.logo||"",this.uri=this.uri||"",this.url=this.url||"",this.groups_above_uuid=this.groups_above_uuid||[],this.search=this.search||"",this.api=this.api||new allplayers.group.api;drupal.node.call(this,a,b)};allplayers.group.prototype=new drupal.node;allplayers.group.prototype.constructor=allplayers.group;allplayers.group.prototype.update=function(a){drupal.node.prototype.update.call(this,a);if(a)this.id=a.uuid||this.id};allplayers.group.prototype.setQuery=function(a,b,c){a[b]=c};
allplayers.group.prototype.getEvents=function(a,b){this.api.getItems(this,"events",a,function(a){for(var d=a.length;d--;)a[d]=new allplayers.event(a[d]);b(a)})};allplayers.group.prototype.getUpcomingEvents=function(a,b){this.api.getItems(this,"events/upcoming",a,function(a){for(var d=a.length;d--;)a[d]=new allplayers.event(a[d]);b(a)})};allplayers.group.prototype.getGroupTree=function(a,b){this.api.getItems(this,"subgroups/tree",{depth:a},b)};allplayers=allplayers||{};
allplayers.group=allplayers.group||{};allplayers.group.api=function(){this.resource="groups";drupal.api.call(this)};allplayers.group.api.prototype=new drupal.api;allplayers.group.api.prototype.constructor=allplayers.group.api;allplayers=allplayers||{};
allplayers.location=function(a,b){if(a)this.street=this.street||"",this.city=this.city||"",this.state=this.state||"",this.zip=this.zip||"",this.country=this.country||"",this.latitude=this.latitude||"",this.longitude=this.longitude||"";drupal.entity.call(this,a,b)};allplayers.location.prototype=new drupal.entity;allplayers.location.prototype.constructor=allplayers.location;allplayers=allplayers||{};
(function(a){var b={dialog:"#calendar-dialog-form"};allplayers.calendars={};if(!a.fn.allplayers_calendar)a.fn.allplayers_calendar=function(c){return a(this).each(function(){allplayers.calendars[a(this).selector]||new allplayers.calendar(a(this),c)})};allplayers.calendar=function(c,d){var e=this,d=a.extend(b,d,{header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},editable:!0,dayClick:function(a,c,b,d){console.log(a);console.log(c);console.log(b);console.log(d)},eventClick:function(a,
c,b){console.log(a);console.log(c);console.log(b)},eventDrop:function(a){a.obj.update(a);a.obj.save()},eventResizeStop:function(a){a.obj.update(a);a.obj.save()},events:function(a,c,b){e.getEvents(a,c,b)}});this.dialog=a(d.dialog,c).hide();allplayers.calendars[d.id]=this;this.uuid="";c.fullCalendar(d)};allplayers.calendar.prototype.onEventClick=function(){console.log("Event has been clicked")};allplayers.calendar.prototype.getUUID=function(a){if(this.uuid)a.call(this);else{var b=this;allplayers.api.searchGroups({search:"Spring Soccer 2011"},
function(e){b.uuid=e[0].uuid;a.call(b)})}};allplayers.calendar.prototype.getEvents=function(a,b,e){var f=a.getFullYear()+"-",f=f+(a.getMonth()+1+"-"),f=f+a.getDate(),g=b.getFullYear()+"-",g=g+(b.getMonth()+1+"-"),g=g+b.getDate();this.getUUID(function(){allplayers.api.getGroupEvents(this.uuid,{start:f,end:g,fields:"*",limit:0,offset:0},function(a){for(var b=a.length;b--;)a[b].id=a[b].uuid,a[b].obj=new allplayers.event(a[b]);e(a)})})}})(jQuery);

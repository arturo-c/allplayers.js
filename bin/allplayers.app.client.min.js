var NO_JQUERY={};
(function(a,c,g){if(!("console"in a)){var l=a.console={};l.log=l.warn=l.error=l.debug=function(){}}c===NO_JQUERY&&(c={fn:{},extend:function(){for(var b=arguments[0],a=1,e=arguments.length;a<e;a++){var f=arguments[a],h;for(h in f)b[h]=f[h]}return b}});c.fn.pm=function(){console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])");return this};c.pm=a.pm=function(b){e.send(b)};c.pm.bind=a.pm.bind=function(b,a,d,f,h){e.bind(b,a,d,f,!0===h)};c.pm.unbind=a.pm.unbind=function(b,
a){e.unbind(b,a)};c.pm.origin=a.pm.origin=null;c.pm.poll=a.pm.poll=200;var e={send:function(b){b=c.extend({},e.defaults,b);var a=b.target;if(b.target)if(b.type){var d={data:b.data,type:b.type};b.success&&(d.callback=e._callback(b.success));b.error&&(d.errback=e._callback(b.error));"postMessage"in a&&!b.hash?(e._bind(),a.postMessage(JSON.stringify(d),b.origin||"*")):(e.hash._bind(),e.hash.send(b,d))}else console.warn("postmessage type required");else console.warn("postmessage target window required")},
bind:function(b,a,d,f,h){e._replyBind(b,a,d,f,h)},_replyBind:function(b,r,d,f,h){"postMessage"in a&&!f?e._bind():e.hash._bind();f=e.data("listeners.postmessage");f||(f={},e.data("listeners.postmessage",f));var m=f[b];m||(m=[],f[b]=m);m.push({fn:r,callback:h,origin:d||c.pm.origin})},unbind:function(b,a){var d=e.data("listeners.postmessage");if(d)if(b)if(a){var f=d[b];if(f){for(var h=[],m=0,p=f.length;m<p;m++){var k=f[m];k.fn!==a&&h.push(k)}d[b]=h}}else delete d[b];else for(m in d)delete d[m]},data:function(b,
a){return a===g?e._data[b]:e._data[b]=a},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var b=[],a=0;32>a;a++)b[a]=e._CHARS[0|32*Math.random()];return b.join("")},_callback:function(b){var a=e.data("callbacks.postmessage");a||(a={},e.data("callbacks.postmessage",a));var d=e._random();a[d]=b;return d},_bind:function(){e.data("listening.postmessage")||(a.addEventListener?a.addEventListener("message",e._dispatch,!1):a.attachEvent&&a.attachEvent("onmessage",
e._dispatch),e.data("listening.postmessage",1))},_dispatch:function(b){try{var a=JSON.parse(b.data)}catch(d){console.warn("postmessage data invalid json: ",d);return}if(a.type){var f=(e.data("callbacks.postmessage")||{})[a.type];if(f)f(a.data);else for(var f=(e.data("listeners.postmessage")||{})[a.type]||[],h=0,m=f.length;h<m;h++){var p=f[h];if(p.origin&&"*"!==p.origin&&b.origin!==p.origin)console.warn("postmessage message origin mismatch",b.origin,p.origin),a.errback&&e.send({target:b.source,data:{message:"postmessage origin mismatch",
origin:[b.origin,p.origin]},type:a.errback});else{var k=function(h){a.callback&&e.send({target:b.source,data:h,type:a.callback})};try{p.callback?p.fn(a.data,k,b):k(p.fn(a.data,b))}catch(c){if(a.errback)e.send({target:b.source,data:c,type:a.errback});else throw c;}}}}else console.warn("postmessage message type required")},hash:{send:function(b,c){var d=b.target,f=b.url;if(f){var f=e.hash._url(f),h,m=e.hash._url(a.location.href);if(a==d.parent)h="parent";else try{for(var p=0,k=parent.frames.length;p<
k;p++)if(parent.frames[p]==a){h=p;break}}catch(g){h=a.name}null==h?console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list"):(h={"x-requested-with":"postmessage",source:{name:h,url:m},postmessage:c},m="#x-postmessage-id="+e._random(),d.location=f+m+encodeURIComponent(JSON.stringify(h)))}else console.warn("postmessage target window url is required")},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:50,_bind:function(){e.data("polling.postmessage")||
(setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);c&&(c=c[1],e.hash._last!==c&&(e.hash._last=c,e.hash._dispatch(b.substring(e.hash._regex_len))))},c.pm.poll||200),e.data("polling.postmessage",1))},_dispatch:function(b){if(b){try{if(b=JSON.parse(decodeURIComponent(b)),!("postmessage"===b["x-requested-with"]&&b.source&&null!=b.source.name&&b.source.url&&b.postmessage))return}catch(c){return}var d=b.postmessage,f=(e.data("callbacks.postmessage")||{})[d.type];if(f)f(d.data);else{var h;
h="parent"===b.source.name?a.parent:a.frames[b.source.name];for(var f=(e.data("listeners.postmessage")||{})[d.type]||[],m=0,p=f.length;m<p;m++){var k=f[m];if(k.origin){var g=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if("*"!==k.origin&&g!==k.origin){console.warn("postmessage message origin mismatch",g,k.origin);d.errback&&e.send({target:h,data:{message:"postmessage origin mismatch",origin:[g,k.origin]},type:d.errback,hash:!0,url:b.source.url});continue}}g=function(a){d.callback&&e.send({target:h,
data:a,type:d.callback,hash:!0,url:b.source.url})};try{k.callback?k.fn(d.data,g):g(k.fn(d.data))}catch(l){if(d.errback)e.send({target:h,data:l,type:d.errback,hash:!0,url:b.source.url});else throw l;}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}}};c.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})})(this,"undefined"===typeof jQuery?NO_JQUERY:jQuery);"JSON"in window&&window.JSON||(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function c(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=d[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function g(a,e){var d,k,l,s,t=b,q,n=e[a];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(a));"function"===typeof f&&(n=f.call(e,a,n));switch(typeof n){case "string":return c(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";b+=r;q=[];if("[object Array]"===Object.prototype.toString.apply(n)){s=n.length;for(d=0;d<s;d+=1)q[d]=g(d,n)||"null";l=0===q.length?"[]":b?"[\n"+b+q.join(",\n"+b)+"\n"+t+"]":"["+q.join(",")+"]";b=t;return l}if(f&&"object"===typeof f)for(s=f.length,d=0;d<s;d+=1)k=f[d],"string"===typeof k&&(l=g(k,n))&&q.push(c(k)+(b?": ":":")+l);else for(k in n)Object.hasOwnProperty.call(n,k)&&(l=g(k,n))&&q.push(c(k)+(b?": ":":")+l);l=0===q.length?"{}":b?"{\n"+b+q.join(",\n"+b)+"\n"+
t+"}":"{"+q.join(",")+"}";b=t;return l}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var l=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,r,d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,e,d){var c;r=b="";if("number"===typeof d)for(c=0;c<d;c+=1)r+=" ";else"string"===typeof d&&(r=d);if((f=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return g("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function e(a,d){var c,f,g=a[d];if(g&&"object"===typeof g)for(c in g)Object.hasOwnProperty.call(g,c)&&(f=e(g,c),void 0!==f?g[c]=f:delete g[c]);return b.call(a,d,g)}var d;l.lastIndex=0;l.test(a)&&(a=a.replace(l,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return d=eval("("+a+")"),"function"===typeof b?e({"":d},""):d;throw new SyntaxError("JSON.parse");})})();var allplayers=allplayers||{};allplayers.app=function(a,c){if(c){a=a||{};for(var g in c)a.hasOwnProperty(g)||(a[g]=c[g]);this.options=a;this.init()}};allplayers.app.getParam=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))};
allplayers.app.prototype.init=function(){document.proxy=this};allplayers=allplayers||{app:{}};allplayers.app.client=function(a){allplayers.app.call(this,a,{getContainer:function(){return jQuery()}})};allplayers.app.client.prototype=new allplayers.app;allplayers.app.client.prototype.constructor=allplayers.app.client;
allplayers.app.client.prototype.init=function(){allplayers.app.prototype.init.call(this);this.ehost=allplayers.app.getParam("ehost");this.container=this.options.getContainer();this.height=0;this.heightTimer=null;this.queue={};this.checkout=this.reg=null;var a=this,c=null;jQuery(document).bind("DOMSubtreeModified",function(){c&&clearTimeout(c);c=setTimeout(function(){a.resize()},500)});jQuery.pm.bind("chromeMsgResp",function(c){if(c.hasOwnProperty("guid")&&a.queue.hasOwnProperty(c.guid))a.queue[c.guid](c.response)});
jQuery.pm.bind("getRegistration",function(c){a.reg=c});jQuery.pm.bind("getCheckout",function(c){a.checkout=c});this.resize();jQuery.pm({target:window.parent,url:this.ehost,type:"clientReady"})};allplayers.app.client.prototype.sendMessage=function(a,c){var g=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};a.guid=g()+g()+g();this.proxy.post({event:{name:"chromeMsg",data:a}});this.queue[a.guid]=c};
allplayers.app.client.prototype.resize=function(){jQuery('a[href^="https://www."]',this.container).each(function(){var a=jQuery(this).attr("href");jQuery(this).attr({href:a.replace(/https:\/\/www.(.*?).allplayers.com/,"https://platform.$1.allplayers.com")})});var a=this,c=function(){var g=a.container.outerHeight(!0);a.height!==g&&(a.height=g,jQuery.pm({target:window.parent,url:a.ehost,type:"init",data:{height:g,id:window.location.hash},success:function(c){a.height=c.height}}));a.heightTimer&&clearTimeout(a.heightTimer);
a.heightTimer=setTimeout(c,500)};c()};
